# ğŸ”‘ RF10 - Logar Operador

![Logo.png](Logo.png){ width=150 }

## ğŸ“ DescriÃ§Ã£o

Este requisito funcional permite que os operadores realizem login no sistema Quilombo Pena Branca, garantindo acesso seguro Ã s funcionalidades de acordo com suas permissÃµes. O processo de autenticaÃ§Ã£o assegura que apenas usuÃ¡rios autorizados possam acessar o sistema.

## ğŸ‘‘ Atores

- Administrador do sistema
- Operador

## âœ… PrÃ©-condiÃ§Ãµes

- O operador deve estar previamente cadastrado no sistema
- O operador deve possuir status ativo
- O sistema deve estar disponÃ­vel e acessÃ­vel

## ğŸŒ Endpoint

- `POST /api/v1/auth/login`

## ğŸ“Š Dados do Login

| Campo    | Tipo   | ObrigatÃ³rio | RestriÃ§Ãµes                         |
|----------|--------|-------------|-----------------------------------|
| cpf      | String | âœ“           | Formato vÃ¡lido: XXX.XXX.XXX-XX    |
| password | String | âœ“           | MÃ­nimo de 8 caracteres            |

## ğŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Acessa a pÃ¡gina de login
    S->>O: Exibe formulÃ¡rio de login
    O->>S: Preenche CPF e senha
    O->>S: Clica no botÃ£o "Entrar"
    S->>DB: Valida credenciais
    DB->>S: Retorna dados do operador
    S->>S: Gera token JWT
    S->>O: Redireciona para a pÃ¡gina inicial
    S->>O: Exibe mensagem de boas-vindas
```

## ğŸ”€ Fluxos Alternativos

### 1. CPF e/ou senha incorretos

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Preenche CPF e/ou senha incorretos
    O->>S: Clica no botÃ£o "Entrar"
    S->>DB: Valida credenciais
    DB->>S: Retorna erro de autenticaÃ§Ã£o
    S->>O: Exibe mensagem "CPF ou senha incorretos"
    S->>O: MantÃ©m na pÃ¡gina de login
```

### 2. Operador inativo

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Preenche CPF e senha
    O->>S: Clica no botÃ£o "Entrar"
    S->>DB: Valida credenciais
    DB->>S: Retorna status inativo
    S->>O: Exibe mensagem "Conta desativada, contate o administrador"
    S->>O: MantÃ©m na pÃ¡gina de login
```

### 3. Bloqueio temporÃ¡rio por tentativas excessivas

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Realiza mÃºltiplas tentativas de login com falha
    S->>DB: Registra tentativas de login
    S->>O: Exibe mensagem "Conta temporariamente bloqueada por seguranÃ§a"
    S->>O: Informa tempo de espera necessÃ¡rio
```

## ğŸ“„ Exemplo de RequisiÃ§Ã£o HTTP

```http
POST /api/v1/auth/login HTTP/1.1
Host: api.quilombopenabranca.org
Content-Type: application/json

{
  "cpf": "123.456.789-00",
  "password": "senha@123"
}
```

## ğŸ“„ Exemplo de Resposta (Sucesso)

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 42,
    "name": "JoÃ£o Silva",
    "cpf": "123.456.789-00",
    "isAdmin": true,
    "status": "ACTIVE",
    "lastLogin": "2023-05-20T15:30:45Z"
  },
  "expiresIn": 3600
}
```

## ğŸ–¼ï¸ Interface de ReferÃªncia

![Interface de Login](login-screen.png)

## ğŸ”’ ConsideraÃ§Ãµes de SeguranÃ§a

- O sistema deve armazenar apenas o hash das senhas, nunca as senhas em texto puro
- As senhas devem ser transmitidas atravÃ©s de conexÃ£o HTTPS
- Tentativas consecutivas de login malsucedidas devem resultar em bloqueio temporÃ¡rio da conta
- O token JWT gerado deve ter tempo de expiraÃ§Ã£o configurÃ¡vel
- Todos os acessos (bem-sucedidos ou nÃ£o) devem ser registrados para fins de auditoria

---

  #### ğŸŒ™ Quilombo Pena Branca ğŸŒ™
  Honrando nossas raÃ­zes, construindo nosso futuro