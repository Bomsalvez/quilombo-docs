# ğŸ“ RF16 - Consultar EndereÃ§o por CEP

![Logo.png](Logo.png){ width=150 }

## ğŸ“ DescriÃ§Ã£o

Este requisito funcional permite que os operadores consultem automaticamente informaÃ§Ãµes de endereÃ§o a partir de um CEP informado, facilitando o cadastro e atualizaÃ§Ã£o de dados de endereÃ§o dos membros do Quilombo Pena Branca. A funcionalidade integra-se a serviÃ§os externos de consulta de CEP, proporcionando preenchimento automÃ¡tico de campos de endereÃ§o e reduzindo erros de digitaÃ§Ã£o.

## ğŸ‘‘ Atores

- Administrador do sistema
- Operador

## âœ… PrÃ©-condiÃ§Ãµes

- O operador deve estar autenticado no sistema
- O sistema deve ter conectividade com os serviÃ§os de consulta de CEP

## ğŸŒ Endpoint

- `GET /api/v1/zipcode/{cep}`

## ğŸ“Š ParÃ¢metros da RequisiÃ§Ã£o

| ParÃ¢metro | Tipo   | ObrigatÃ³rio | RestriÃ§Ãµes                     |
|-----------|--------|-------------|--------------------------------|
| cep       | String | âœ“           | Formato: XXXXX-XXX ou XXXXXXXX |

## ğŸ“Š Dados Retornados

| Campo       | Tipo   | DescriÃ§Ã£o                   |
|-------------|--------|-----------------------------|
| cep         | String | CEP no formato XXXXX-XXX    |
| logradouro  | String | Nome da rua, avenida, etc.  |
| complemento | String | Complemento (se disponÃ­vel) |
| bairro      | String | Bairro                      |
| localidade  | String | Cidade                      |
| uf          | String | Estado (sigla)              |
| ibge        | String | CÃ³digo IBGE                 |
| ddd         | String | CÃ³digo DDD da regiÃ£o        |

## ğŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant API as ServiÃ§o de CEP
    
    O->>S: Informa CEP no campo especÃ­fico
    O->>S: Sai do campo ou clica em "Buscar CEP"
    S->>S: Valida formato do CEP
    S->>API: Consulta dados do CEP
    API->>S: Retorna dados do endereÃ§o
    S->>O: Preenche automaticamente campos de endereÃ§o
    O->>S: Complementa informaÃ§Ãµes especÃ­ficas (nÃºmero, complemento)
```

## ğŸ”€ Fluxos Alternativos

### 1. CEP invÃ¡lido ou mal formatado

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    
    O->>S: Informa CEP em formato invÃ¡lido
    O->>S: Sai do campo ou clica em "Buscar CEP"
    S->>S: Valida formato do CEP
    S->>O: Exibe mensagem "CEP invÃ¡lido. Use o formato XXXXX-XXX"
    S->>O: MantÃ©m foco no campo CEP
```

### 2. CEP nÃ£o encontrado

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant API as ServiÃ§o de CEP
    
    O->>S: Informa CEP vÃ¡lido mas inexistente
    O->>S: Sai do campo ou clica em "Buscar CEP"
    S->>S: Valida formato do CEP
    S->>API: Consulta dados do CEP
    API->>S: Retorna erro de CEP nÃ£o encontrado
    S->>O: Exibe mensagem "CEP nÃ£o encontrado"
    S->>O: Habilita campos para preenchimento manual
```

### 3. Erro no serviÃ§o de CEP

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant API as ServiÃ§o de CEP
    
    O->>S: Informa CEP
    O->>S: Sai do campo ou clica em "Buscar CEP"
    S->>S: Valida formato do CEP
    S->>API: Consulta dados do CEP
    API->>S: Retorna erro de serviÃ§o
    S->>O: Exibe mensagem "ServiÃ§o de CEP indisponÃ­vel"
    S->>O: Habilita campos para preenchimento manual
    S->>S: Registra falha para monitoramento
```

## ğŸ“„ Exemplo de RequisiÃ§Ã£o e Resposta

### Consulta de CEP

**RequisiÃ§Ã£o:**
```http
GET /api/v1/zipcode/01001-000 HTTP/1.1
Host: api.quilombopenabranca.org
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Resposta:**
```json
{
  "cep": "01001-000",
  "logradouro": "PraÃ§a da SÃ©",
  "complemento": "lado Ã­mpar",
  "bairro": "SÃ©",
  "localidade": "SÃ£o Paulo",
  "uf": "SP",
  "ibge": "3550308",
  "ddd": "11"
}
```

## ğŸ–¼ï¸ Interface de ReferÃªncia

![cep.png](cep.png)

## ğŸ”„ IntegraÃ§Ã£o com FormulÃ¡rios

A funcionalidade de consulta de CEP Ã© integrada aos seguintes formulÃ¡rios no sistema:

- Cadastro de Membros
- EdiÃ§Ã£o de Membros
- Cadastro de Operadores
- EdiÃ§Ã£o de Operadores

## ğŸŒ ServiÃ§os de CEP Utilizados

O sistema utiliza os seguintes serviÃ§os de CEP, em ordem de prioridade:

1. ViaCEP (https://viacep.com.br)
2. BrasilAPI (https://brasilapi.com.br)
3. ServiÃ§o de contingÃªncia interno (cache de CEPs jÃ¡ consultados)

## ğŸ’¾ Armazenamento em Cache

Para otimizar o desempenho e reduzir chamadas aos serviÃ§os externos, o sistema mantÃ©m um cache local dos CEPs consultados recentemente, com as seguintes caracterÃ­sticas:

- Tempo de expiraÃ§Ã£o do cache: 30 dias
- AtualizaÃ§Ã£o automÃ¡tica do cache em caso de erro no CEP armazenado
- Limite de 10.000 CEPs no cache

## ğŸ”’ ConsideraÃ§Ãµes de SeguranÃ§a

- A comunicaÃ§Ã£o com os serviÃ§os de CEP Ã© feita via HTTPS
- Os dados retornados sÃ£o validados antes de serem apresentados na interface
- O sistema nÃ£o compartilha dados dos usuÃ¡rios com os serviÃ§os de CEP

---

  #### ğŸŒ™ Quilombo Pena Branca ğŸŒ™
  Honrando nossas raÃ­zes, construindo nosso futuro