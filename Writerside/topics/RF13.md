# üìã RF13 - Listar e Consultar Obriga√ß√µes

![Logo.png](Logo.png){ width=150 }

## üìù Descri√ß√£o

Este requisito funcional permite que os operadores visualizem, consultem e filtrem as obriga√ß√µes religiosas registradas para os membros do Quilombo Pena Branca. A consulta pode ser realizada para todas as obriga√ß√µes ou de forma espec√≠fica para um determinado membro, possibilitando o acompanhamento do hist√≥rico espiritual da comunidade.

## üëë Atores

- Administrador do sistema
- Operador

## ‚úÖ Pr√©-condi√ß√µes

- O operador deve estar autenticado no sistema
- O operador deve possuir permiss√£o para visualizar obriga√ß√µes

## üåê Endpoints

- `GET /api/v1/obligations` (listar todas as obriga√ß√µes)
- `GET /api/v1/obligations/{id}` (consultar obriga√ß√£o espec√≠fica)
- `GET /api/v1/obligations/member/{memberId}` (listar obriga√ß√µes de um membro)

## üìä Par√¢metros de Consulta

| Par√¢metro  | Tipo      | Obrigat√≥rio | Descri√ß√£o                          | Exemplo                 |
|------------|-----------|-------------|------------------------------------|-------------------------|
| page       | Integer   | ‚ùå           | N√∫mero da p√°gina (pagina√ß√£o)       | `?page=0`               |
| size       | Integer   | ‚ùå           | Quantidade de registros por p√°gina | `?size=20`              |
| sort       | String    | ‚ùå           | Campo e dire√ß√£o de ordena√ß√£o       | `?sort=date,desc`       |
| type       | String    | ‚ùå           | Filtro por tipo de obriga√ß√£o       | `?type=INICIACAO`       |
| startDate  | LocalDate | ‚ùå           | Data inicial para filtro           | `?startDate=2022-01-01` |
| endDate    | LocalDate | ‚ùå           | Data final para filtro             | `?endDate=2022-12-31`   |
| memberName | String    | ‚ùå           | Nome ou parte do nome do membro    | `?memberName=Maria`     |
| officiant  | String    | ‚ùå           | Nome ou parte do nome do oficiante | `?officiant=Pai%20Jo√£o` |

## üîÑ Fluxo Principal - Listar Todas Obriga√ß√µes

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Acessa a p√°gina de obriga√ß√µes
    S->>DB: Busca obriga√ß√µes com pagina√ß√£o
    DB->>S: Retorna lista de obriga√ß√µes
    S->>O: Exibe lista de obriga√ß√µes
    O->>S: Aplica filtros (opcional)
    S->>DB: Busca obriga√ß√µes com filtros
    DB->>S: Retorna lista filtrada
    S->>O: Atualiza lista de obriga√ß√µes
```

## üîÑ Fluxo Principal - Consultar Obriga√ß√£o Espec√≠fica

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Seleciona uma obriga√ß√£o da lista
    S->>DB: Busca detalhes da obriga√ß√£o
    DB->>S: Retorna dados completos
    S->>O: Exibe tela de detalhes da obriga√ß√£o
    S->>DB: Busca informa√ß√µes adicionais do membro
    DB->>S: Retorna dados do membro
    S->>O: Complementa exibi√ß√£o com dados do membro
```

## üîÑ Fluxo Principal - Listar Obriga√ß√µes de um Membro

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Acessa p√°gina de detalhes do membro
    S->>O: Exibe informa√ß√µes do membro
    O->>S: Clica na aba "Obriga√ß√µes" do membro
    S->>DB: Busca obriga√ß√µes do membro
    DB->>S: Retorna lista de obriga√ß√µes
    S->>O: Exibe hist√≥rico de obriga√ß√µes do membro
```

## üîÄ Fluxos Alternativos

### 1. Nenhuma obriga√ß√£o encontrada

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Acessa a p√°gina de obriga√ß√µes ou aplica filtros
    S->>DB: Busca obriga√ß√µes
    DB->>S: Retorna lista vazia
    S->>O: Exibe mensagem "Nenhuma obriga√ß√£o encontrada"
    S->>O: Oferece op√ß√µes para limpar filtros ou cadastrar nova
```

### 2. Obriga√ß√£o espec√≠fica n√£o encontrada

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Tenta acessar uma obriga√ß√£o por ID n√£o existente
    S->>DB: Busca obriga√ß√£o por ID
    DB->>S: Retorna que obriga√ß√£o n√£o existe
    S->>O: Exibe mensagem de erro
    S->>O: Redireciona para a lista de obriga√ß√µes
```

## üìÑ Exemplo de Requisi√ß√£o e Resposta

### Listar todas as obriga√ß√µes (com pagina√ß√£o)

**Requisi√ß√£o:**
```http
GET /api/v1/obligations?page=0&size=10&sort=date,desc HTTP/1.1
Host: api.quilombopenabranca.org
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Resposta:**
```json
{
  "content": [
    {
      "id": 123,
      "memberId": 42,
      "memberName": "Maria da Silva",
      "type": "INICIACAO",
      "date": "2023-05-15",
      "description": "Inicia√ß√£o de santo no Candombl√© Angola",
      "officiant": "Pai Jo√£o de Angola",
      "location": "Terreiro Pena Branca",
      "createdAt": "2023-05-20T14:30:45Z"
    },
    {
      "id": 122,
      "memberId": 38,
      "memberName": "Jos√© Santos",
      "type": "OBORI",
      "date": "2023-05-10",
      "description": "Obori para fortalecimento espiritual",
      "officiant": "M√£e Joana de Oy√°",
      "location": "Terreiro Pena Branca",
      "createdAt": "2023-05-12T10:15:20Z"
    }
    // ... mais itens
  ],
  "pageable": {
    "pageNumber": 0,
    "pageSize": 10,
    "sort": {
      "sorted": true,
      "unsorted": false,
      "empty": false
    },
    "offset": 0,
    "unpaged": false,
    "paged": true
  },
  "totalElements": 58,
  "totalPages": 6,
  "last": false,
  "size": 10,
  "number": 0,
  "sort": {
    "sorted": true,
    "unsorted": false,
    "empty": false
  },
  "numberOfElements": 10,
  "first": true,
  "empty": false
}
```

### Consultar obriga√ß√£o espec√≠fica

**Requisi√ß√£o:**
```http
GET /api/v1/obligations/123 HTTP/1.1
Host: api.quilombopenabranca.org
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Resposta:**
```json
{
  "id": 123,
  "memberId": 42,
  "memberName": "Maria da Silva",
  "memberDetails": {
    "id": 42,
    "name": "Maria da Silva",
    "nickname": "Maria de Ians√£",
    "photo": "https://storage.quilombopenabranca.org/members/42/photo.jpg",
    "isRodante": true
  },
  "type": "INICIACAO",
  "date": "2023-05-15",
  "description": "Inicia√ß√£o de santo no Candombl√© Angola",
  "observations": "Cerim√¥nia ocorreu sem intercorr√™ncias",
  "officiant": "Pai Jo√£o de Angola",
  "location": "Terreiro Pena Branca",
  "createdAt": "2023-05-20T14:30:45Z",
  "createdBy": "Carlos Operador",
  "updatedAt": null,
  "updatedBy": null,
  "attachments": [
    {
      "id": 1,
      "filename": "foto_cerimonia.jpg",
      "contentType": "image/jpeg",
      "size": 1245678,
      "uploadDate": "2023-05-20T14:35:12Z",
      "url": "https://storage.quilombopenabranca.org/obligations/123/foto_cerimonia.jpg"
    }
  ]
}
```

## üñºÔ∏è Interface de Refer√™ncia

![Interface de Listagem de Obriga√ß√µes](obligations-list.png)

## üîç Funcionalidades Adicionais

- **Exporta√ß√£o de Dados**: Possibilidade de exportar a lista de obriga√ß√µes em formato CSV ou PDF
- **Visualiza√ß√£o de Anexos**: Visualiza√ß√£o de fotos e documentos anexados √† obriga√ß√£o
- **Linha do Tempo**: Visualiza√ß√£o cronol√≥gica das obriga√ß√µes de um membro espec√≠fico
- **Estat√≠sticas**: Gr√°ficos e n√∫meros sobre as obriga√ß√µes realizadas por per√≠odo

---

  #### üåô Quilombo Pena Branca üåô
  Honrando nossas ra√≠zes, construindo nosso futuro