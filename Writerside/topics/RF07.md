# ‚úèÔ∏è RF07 - Editar Membro

![Logo.png](Logo.png){ width=150 }

## üìù Descri√ß√£o

Esta funcionalidade permite que o operador atualize os dados de um membro j√° cadastrado no sistema Quilombo Pena Branca, mantendo o hist√≥rico de informa√ß√µes atualizado.

## üëë Atores

- Administrador do sistema
- Operador

## ‚ö†Ô∏è Pr√©-condi√ß√µes

- O operador deve estar autenticado no sistema
- O membro a ser editado deve estar cadastrado no sistema
- O CPF n√£o pode ser alterado para um CPF j√° cadastrado para outro membro

## üîå Endpoints

- `PUT /api/v1/members/{id}`

## üìã Dados do Membro

| Campo              | Tipo      | Obrigat√≥rio | Descri√ß√£o                                    | Restri√ß√µes                      |
|--------------------|-----------|-------------|----------------------------------------------|---------------------------------|
| `name`             | `string`  | ‚úÖ Sim       | Nome completo do membro                      | M√≠nimo de 3 caracteres          |
| `email`            | `string`  | ‚úÖ Sim       | E-mail do membro                             | Formato v√°lido de e-mail        |
| `cpf`              | `string`  | ‚úÖ Sim       | CPF do membro                                | Formato v√°lido (999.999.999-99) |
| `phone`            | `string`  | ‚úÖ Sim       | Telefone do membro                           | Formato v√°lido                  |
| `dateOfBirth`      | `date`    | ‚úÖ Sim       | Data de nascimento                           | Formato v√°lido (YYYY-MM-DD)     |
| `entryDate`        | `date`    | ‚úÖ Sim       | Data entrada no terreiro/Associa√ß√£o/Quilombo | Formato v√°lido (YYYY-MM-DD)     |
| `biologicalFather` | `string`  | ‚úÖ Sim       | Pai (biol√≥gico)                              | M√≠nimo de 3 caracteres          |
| `biologicalMother` | `string`  | ‚úÖ Sim       | M√£e (biol√≥gica)                              | M√≠nimo de 3 caracteres          |
| `spiritualFather`  | `string`  | ‚úÖ Sim       | Pai (santo)                                  | M√≠nimo de 3 caracteres          |
| `spiritualMother`  | `string`  | ‚úÖ Sim       | M√£e (santo)                                  | M√≠nimo de 3 caracteres          |
| `initiationDate`   | `date`    | ‚úÖ Sim       | Data da Feitura                              | Formato v√°lido (YYYY-MM-DD)     |
| `obligationsDate`  | `date`    | ‚úÖ Sim       | Data das obriga√ß√µes                          | Formato v√°lido (YYYY-MM-DD)     |
| `isRodante`        | `boolean` | ‚úÖ Sim       | Se o membro √© rodante                        | true/false                      |
| `positions`        | `array`   | ‚ùå N√£o       | Cargos do membro                             | Array de IDs de cargos          |
| `address`          | `object`  | ‚úÖ Sim       | Endere√ßo completo                            | Objeto com dados de endere√ßo    |

## üè† Dados do Endere√ßo

| Campo       | Tipo     | Obrigat√≥rio | Descri√ß√£o        | Restri√ß√µes         |
|-------------|----------|-------------|------------------|---------------------|
| `zipCode`   | `string` | ‚úÖ Sim      | CEP              | Formato: 99999-999  |
| `street`    | `string` | ‚úÖ Sim      | Rua/Logradouro   | -                   |
| `number`    | `string` | ‚úÖ Sim      | N√∫mero           | -                   |
| `complement`| `string` | ‚ùå N√£o      | Complemento      | -                   |
| `district`  | `string` | ‚úÖ Sim      | Bairro           | -                   |
| `city`      | `string` | ‚úÖ Sim      | Cidade           | -                   |
| `state`     | `string` | ‚úÖ Sim      | Estado           | 2 caracteres (sigla)|

## üîÑ Fluxo Principal

```mermaid
sequenceDiagram
    actor O as Operador
    participant S as Sistema
    participant BD as Banco de Dados
    
    O->>S: Acessa a p√°gina de detalhes do membro
    S->>BD: Busca dados do membro
    BD->>S: Retorna dados do membro
    S->>O: Exibe dados do membro com op√ß√£o de edi√ß√£o
    O->>S: Clica em editar membro
    S->>O: Exibe formul√°rio preenchido com dados atuais
    O->>S: Modifica os dados necess√°rios
    O->>S: Envia formul√°rio
    S->>S: Valida dados informados
    S->>BD: Atualiza dados do membro
    S->>O: Exibe mensagem de confirma√ß√£o
```

1. O operador acessa a p√°gina de detalhes do membro que deseja editar.
2. O sistema exibe os dados atuais do membro com op√ß√£o de edi√ß√£o.
3. O operador clica em "Editar Membro".
4. O sistema exibe um formul√°rio preenchido com os dados atuais do membro.
5. O operador modifica os campos necess√°rios.
6. O operador envia o formul√°rio com as altera√ß√µes.
7. O sistema valida os dados informados.
8. O sistema atualiza os dados do membro.
9. O sistema exibe uma mensagem de confirma√ß√£o da atualiza√ß√£o.

## üîÄ Fluxos Alternativos

### ‚ö†Ô∏è F01 - CPF alterado para um j√° existente

```mermaid
sequenceDiagram
    actor O as Operador
    participant S as Sistema
    participant BD as Banco de Dados
    
    O->>S: Modifica dados incluindo CPF
    O->>S: Envia formul√°rio
    S->>BD: Verifica se CPF j√° existe para outro membro
    BD->>S: CPF j√° existe para outro membro
    S->>O: Exibe mensagem de erro
```

1. No passo 5 do fluxo principal, o operador altera o CPF do membro.
2. O operador envia o formul√°rio com as altera√ß√µes.
3. O sistema verifica que o CPF j√° est√° cadastrado para outro membro.
4. O sistema exibe uma mensagem de erro informando que o CPF j√° est√° em uso.
5. O sistema mant√©m os dados j√° preenchidos para corre√ß√£o.

### ‚ö†Ô∏è F02 - Dados inv√°lidos

1. No passo 7 do fluxo principal, o sistema identifica dados inv√°lidos (formato incorreto, campos obrigat√≥rios em branco).
2. O sistema exibe mensagens espec√≠ficas para cada erro encontrado.
3. O sistema mant√©m os dados j√° preenchidos para corre√ß√£o.

## üß™ Exemplo de Requisi√ß√£o

### Requisi√ß√£o HTTP
```http
PUT /api/v1/members/42 HTTP/1.1
Host: api.quilombopenabranca.org
Content-Type: application/json
Authorization: Bearer {token}

{
  "name": "Maria da Silva Santos",
  "email": "maria.santos@email.com",
  "cpf": "123.456.789-01",
  "phone": "(11) 98765-4321",
  "dateOfBirth": "1985-05-12",
  "entryDate": "2018-03-20",
  "biologicalFather": "Jo√£o da Silva",
  "biologicalMother": "Ana da Silva",
  "spiritualFather": "Jos√© de Ox√≥ssi",
  "spiritualMother": "Maria de Iemanj√°",
  "initiationDate": "2019-06-15",
  "obligationsDate": "2022-06-15",
  "isRodante": true,
  "positions": [3, 7],
  "address": {
    "zipCode": "01234-567",
    "street": "Rua das Flores",
    "number": "123",
    "complement": "Apto 45B",
    "district": "Jardim Primavera",
    "city": "S√£o Paulo",
    "state": "SP"
  }
}
```

### Resposta de Sucesso
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 42,
  "name": "Maria da Silva Santos",
  "cpf": "123.456.789-01",
  "isRodante": true,
  "updatedAt": "2023-06-20T09:15:30Z"
}
```

## üñºÔ∏è Interface de Refer√™ncia

![Formul√°rio de Edi√ß√£o de Membro](https://via.placeholder.com/800x600.png?text=Formul√°rio+de+Edi√ß√£o+de+Membro)

---

  #### üåô Quilombo Pena Branca üåô
  ***Honrando nossas ra√≠zes, construindo nosso futuro***
