# ‚úèÔ∏è RF02 - Editar Operador

![Logo.png](Logo.png){ width=150 }

## üìù Descri√ß√£o

Esta funcionalidade permite que o administrador atualize os dados de um operador j√° cadastrado no sistema Quilombo Pena Branca, garantindo que as informa√ß√µes de acesso estejam sempre corretas e atualizadas.

## üëë Atores

- Administrador do sistema

## ‚ö†Ô∏è Pr√©-condi√ß√µes

- O administrador deve estar autenticado no sistema
- O operador a ser editado deve estar cadastrado no sistema
- O CPF n√£o pode ser alterado para um CPF j√° cadastrado para outro operador

## üîå Endpoints

- `PUT /api/v1/users/{id}`

## üìã Dados do Operador

| Campo      | Tipo     | Obrigat√≥rio | Descri√ß√£o             | Restri√ß√µes                      |
|------------|----------|-------------|----------------------|----------------------------------|
| `name`     | `string` | ‚úÖ Sim      | Nome do operador      | M√≠nimo de 3 caracteres          |
| `cpf`      | `string` | ‚úÖ Sim      | CPF do operador       | Formato v√°lido (999.999.999-99) |
| `password` | `string` | ‚ùå N√£o      | Nova senha do operador| M√≠nimo de 8 caracteres          |
| `isAdmin`  | `boolean`| ‚úÖ Sim      | Se √© administrador    | true/false                      |
| `status`   | `string` | ‚úÖ Sim      | Status do operador    | "ACTIVE" ou "INACTIVE"          |

## üîÑ Fluxo Principal

```mermaid
sequenceDiagram
    actor A as Administrador
    participant S as Sistema
    participant BD as Banco de Dados
    
    A->>S: Acessa a p√°gina de listagem de operadores
    S->>BD: Busca operadores cadastrados
    BD->>S: Retorna lista de operadores
    S->>A: Exibe lista de operadores
    A->>S: Seleciona operador para edi√ß√£o
    S->>BD: Busca dados detalhados do operador
    BD->>S: Retorna dados do operador
    S->>A: Exibe formul√°rio com dados atuais
    A->>S: Modifica os dados necess√°rios
    A->>S: Envia formul√°rio
    S->>S: Valida dados informados
    S->>BD: Atualiza dados do operador
    S->>A: Exibe mensagem de confirma√ß√£o
```

1. O administrador acessa a p√°gina de listagem de operadores.
2. O sistema exibe a lista de operadores cadastrados.
3. O administrador seleciona o operador que deseja editar.
4. O sistema exibe um formul√°rio preenchido com os dados atuais do operador.
5. O administrador modifica os campos necess√°rios.
6. O administrador envia o formul√°rio com as altera√ß√µes.
7. O sistema valida os dados informados.
8. O sistema atualiza os dados do operador.
9. O sistema exibe uma mensagem de confirma√ß√£o da atualiza√ß√£o.

## üîÄ Fluxos Alternativos

### ‚ö†Ô∏è F01 - CPF alterado para um j√° existente

```mermaid
sequenceDiagram
    actor A as Administrador
    participant S as Sistema
    participant BD as Banco de Dados
    
    A->>S: Modifica dados incluindo CPF
    A->>S: Envia formul√°rio
    S->>BD: Verifica se CPF j√° existe para outro operador
    BD->>S: CPF j√° existe para outro operador
    S->>A: Exibe mensagem de erro
```

1. No passo 5 do fluxo principal, o administrador altera o CPF do operador.
2. O administrador envia o formul√°rio com as altera√ß√µes.
3. O sistema verifica que o CPF j√° est√° cadastrado para outro operador.
4. O sistema exibe uma mensagem de erro informando que o CPF j√° est√° em uso.
5. O sistema mant√©m os dados j√° preenchidos para corre√ß√£o.

### ‚ö†Ô∏è F02 - Operador n√£o encontrado

1. No passo 3 do fluxo principal, o sistema n√£o encontra o operador solicitado.
2. O sistema exibe uma mensagem informando que o operador n√£o foi encontrado.
3. O sistema redireciona o administrador para a p√°gina de listagem de operadores.

### ‚ö†Ô∏è F03 - Dados inv√°lidos

1. No passo 7 do fluxo principal, o sistema identifica dados inv√°lidos (formato incorreto, campos obrigat√≥rios em branco).
2. O sistema exibe mensagens espec√≠ficas para cada erro encontrado.
3. O sistema mant√©m os dados j√° preenchidos para corre√ß√£o.

## üß™ Exemplo de Requisi√ß√£o

### Requisi√ß√£o HTTP
```http
PUT /api/v1/users/42 HTTP/1.1
Host: api.quilombopenabranca.org
Content-Type: application/json
Authorization: Bearer {token}

{
  "name": "Jo√£o da Silva Santos",
  "cpf": "123.456.789-01",
  "password": "novasenha@123",
  "isAdmin": false,
  "status": "ACTIVE"
}
```

### Resposta de Sucesso
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 42,
  "name": "Jo√£o da Silva Santos",
  "cpf": "123.456.789-01",
  "isAdmin": false,
  "status": "ACTIVE",
  "updatedAt": "2023-06-20T09:15:30Z"
}
```

## üñºÔ∏è Interface de Refer√™ncia

![Formul√°rio de Edi√ß√£o de Operador](https://via.placeholder.com/800x500.png?text=Formul√°rio+de+Edi√ß√£o+de+Operador)

## üîê Considera√ß√µes de Seguran√ßa

- A senha s√≥ √© atualizada se o campo for preenchido
- N√£o √© poss√≠vel visualizar a senha atual do operador
- Somente administradores podem editar outros operadores
- Um operador pode editar seus pr√≥prios dados, exceto o campo `isAdmin`
- Todas as altera√ß√µes s√£o registradas no log do sistema para auditoria

---

  #### üåô Quilombo Pena Branca üåô
  ***Honrando nossas ra√≠zes, construindo nosso futuro***