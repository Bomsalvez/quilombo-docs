# ğŸ—‘ï¸ RF03 - Excluir Operador

![Logo.png](Logo.png){ width=150 }

## ğŸ“ DescriÃ§Ã£o

Esta funcionalidade permite que o administrador desative ou exclua um operador do sistema Quilombo Pena Branca, impedindo seu acesso ao sistema quando necessÃ¡rio, por exemplo, em caso de desligamento.

## ğŸ‘‘ Atores

- Administrador do sistema

## âš ï¸ PrÃ©-condiÃ§Ãµes

- O administrador deve estar autenticado no sistema
- O operador a ser excluÃ­do deve estar cadastrado no sistema
- O administrador nÃ£o pode excluir sua prÃ³pria conta
- Deve haver pelo menos um administrador ativo no sistema

## ğŸ”Œ Endpoints

- `DELETE /api/v1/users/{id}`

## ğŸ“‹ Dados para ExclusÃ£o

| Campo        | Tipo     | ObrigatÃ³rio | DescriÃ§Ã£o                  | RestriÃ§Ãµes             |
|--------------|----------|-------------|----------------------------|------------------------|
| `id`         | `integer`| âœ… Sim      | ID do operador a excluir   | Deve existir no sistema|
| `reason`     | `string` | âœ… Sim      | Motivo da exclusÃ£o         | MÃ­nimo de 5 caracteres |
| `softDelete` | `boolean`| âŒ NÃ£o      | ExclusÃ£o lÃ³gica ou fÃ­sica  | Default: true (lÃ³gica) |

## ğŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    actor A as Administrador
    participant S as Sistema
    participant BD as Banco de Dados
    
    A->>S: Acessa a pÃ¡gina de listagem de operadores
    S->>BD: Busca operadores cadastrados
    BD->>S: Retorna lista de operadores
    S->>A: Exibe lista de operadores
    A->>S: Seleciona operador para exclusÃ£o
    S->>A: Exibe tela de confirmaÃ§Ã£o com campo para motivo
    A->>S: Preenche motivo e confirma exclusÃ£o
    S->>S: Valida dados e verifica regras de negÃ³cio
    S->>BD: Marca operador como inativo (exclusÃ£o lÃ³gica)
    BD->>S: Confirma exclusÃ£o
    S->>A: Exibe mensagem de confirmaÃ§Ã£o
```

1. O administrador acessa a pÃ¡gina de listagem de operadores.
2. O sistema exibe a lista de operadores cadastrados.
3. O administrador seleciona o operador que deseja excluir.
4. O sistema exibe uma tela de confirmaÃ§Ã£o com campo para informar o motivo da exclusÃ£o.
5. O administrador preenche o motivo e confirma a exclusÃ£o.
6. O sistema valida os dados e verifica as regras de negÃ³cio (nÃ£o pode excluir o Ãºltimo administrador).
7. O sistema marca o operador como inativo (exclusÃ£o lÃ³gica).
8. O sistema exibe uma mensagem de confirmaÃ§Ã£o da exclusÃ£o.

## ğŸ”€ Fluxos Alternativos

### âš ï¸ F01 - Operador nÃ£o encontrado

```mermaid
sequenceDiagram
    actor A as Administrador
    participant S as Sistema
    participant BD as Banco de Dados
    
    A->>S: Tenta excluir um operador
    S->>BD: Busca operador pelo ID
    BD->>S: Operador nÃ£o encontrado
    S->>A: Exibe mensagem de erro
```

1. No passo 3 do fluxo principal, o sistema verifica que o operador nÃ£o existe.
2. O sistema exibe uma mensagem informando que o operador nÃ£o foi encontrado.
3. O sistema mantÃ©m o administrador na pÃ¡gina de listagem de operadores.

### âš ï¸ F02 - Tentativa de excluir o Ãºltimo administrador

```mermaid
sequenceDiagram
    actor A as Administrador
    participant S as Sistema
    participant BD as Banco de Dados
    
    A->>S: Tenta excluir um operador administrador
    S->>BD: Verifica se Ã© o Ãºltimo administrador
    BD->>S: Confirma que Ã© o Ãºltimo administrador
    S->>A: Exibe mensagem de erro
```

1. No passo 6 do fluxo principal, o sistema verifica que o operador Ã© o Ãºltimo administrador.
2. O sistema exibe uma mensagem informando que nÃ£o Ã© possÃ­vel excluir o Ãºltimo administrador.
3. A operaÃ§Ã£o Ã© cancelada.

### âš ï¸ F03 - Tentativa de excluir a prÃ³pria conta

1. No passo 5 do fluxo principal, o sistema verifica que o administrador estÃ¡ tentando excluir sua prÃ³pria conta.
2. O sistema exibe uma mensagem informando que nÃ£o Ã© possÃ­vel excluir a prÃ³pria conta.
3. A operaÃ§Ã£o Ã© cancelada.

## ğŸ§ª Exemplo de RequisiÃ§Ã£o

### RequisiÃ§Ã£o HTTP
```http
DELETE /api/v1/users/42 HTTP/1.1
Host: api.quilombopenabranca.org
Content-Type: application/json
Authorization: Bearer {token}

{
  "reason": "Desligamento do funcionÃ¡rio",
  "softDelete": true
}
```

### Resposta de Sucesso
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "message": "Operador excluÃ­do com sucesso",
  "deletedAt": "2023-06-20T09:15:30Z"
}
```

## ğŸ–¼ï¸ Interface de ConfirmaÃ§Ã£o

![ConfirmaÃ§Ã£o de ExclusÃ£o de Operador](https://via.placeholder.com/600x400.png?text=ConfirmaÃ§Ã£o+de+ExclusÃ£o+de+Operador)

## âš ï¸ Impactos da ExclusÃ£o

Quando um operador Ã© excluÃ­do do sistema:

- ğŸš« NÃ£o pode mais realizar login no sistema
- ğŸ“ Seu registro permanece no banco de dados para fins de auditoria (exclusÃ£o lÃ³gica)
- ğŸ”„ Pode ser reativado posteriormente por um administrador, se necessÃ¡rio
- ğŸ“Š Suas aÃ§Ãµes passadas permanecem registradas nos logs do sistema
- ğŸ‘¤ Seu nome continua aparecendo nos registros de atividades realizadas anteriormente

## ğŸ” ConsideraÃ§Ãµes de SeguranÃ§a

- Por padrÃ£o, a exclusÃ£o Ã© lÃ³gica (softDelete = true)
- Para exclusÃ£o fÃ­sica (remoÃ§Ã£o do banco de dados), Ã© necessÃ¡rio acesso direto ao banco
- Todas as tentativas de exclusÃ£o sÃ£o registradas no log do sistema
- A exclusÃ£o de um operador nÃ£o afeta os dados de membros cadastrados por ele

---

<div align="center">
  <h3>ğŸŒ™ Quilombo Pena Branca ğŸŒ™</h3>
  <p>Honrando nossas raÃ­zes, construindo nosso futuro</p>
</div>
