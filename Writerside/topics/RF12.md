# ğŸ“ RF12 - Cadastrar ObrigaÃ§Ã£o

![Logo.png](Logo.png){ width=150 }

## ğŸ“ DescriÃ§Ã£o

Este requisito funcional permite que os operadores registrem novas obrigaÃ§Ãµes religiosas para os membros do Quilombo Pena Branca. As obrigaÃ§Ãµes religiosas sÃ£o elementos fundamentais das prÃ¡ticas culturais e espirituais da comunidade, possibilitando o acompanhamento da trajetÃ³ria espiritual de cada membro.

## ğŸ‘‘ Atores

- Administrador do sistema
- Operador

## âœ… PrÃ©-condiÃ§Ãµes

- O operador deve estar autenticado no sistema
- O membro para o qual a obrigaÃ§Ã£o serÃ¡ registrada deve estar cadastrado e ativo
- O operador deve possuir permissÃ£o para cadastrar obrigaÃ§Ãµes

## ğŸŒ Endpoint

- `POST /api/v1/obligations`

## ğŸ“Š Dados da ObrigaÃ§Ã£o

| Campo        | Tipo       | ObrigatÃ³rio | RestriÃ§Ãµes                                |
|--------------|------------|-------------|-------------------------------------------|
| memberId     | Long       | âœ“           | ID de membro existente no sistema         |
| type         | String     | âœ“           | Tipo da obrigaÃ§Ã£o (enum de tipos vÃ¡lidos) |
| date         | LocalDate  | âœ“           | Data nÃ£o pode ser futura                  |
| description  | String     | âœ“           | MÃ­nimo 10, mÃ¡ximo 500 caracteres          |
| observations | String     | âŒ           | MÃ¡ximo 1000 caracteres                    |
| officiant    | String     | âœ“           | Nome do oficiante/responsÃ¡vel             |
| location     | String     | âœ“           | Local onde foi realizada                  |
| attachments  | List<File> | âŒ           | Arquivos relacionados (fotos, documentos) |

## ğŸ”„ Fluxo Principal

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Acessa a pÃ¡gina de cadastro de obrigaÃ§Ãµes
    S->>O: Exibe formulÃ¡rio de cadastro
    O->>S: Seleciona o membro
    S->>DB: Busca dados do membro
    DB->>S: Retorna dados do membro
    S->>O: Preenche automaticamente dados do membro
    O->>S: Preenche dados da obrigaÃ§Ã£o
    O->>S: Anexa arquivos (opcional)
    O->>S: Clica no botÃ£o "Salvar"
    S->>S: Valida os dados informados
    S->>DB: Armazena a obrigaÃ§Ã£o
    DB->>S: Confirma salvamento
    S->>O: Exibe mensagem de confirmaÃ§Ã£o
    S->>O: Redireciona para a pÃ¡gina de detalhes da obrigaÃ§Ã£o
```

## ğŸ”€ Fluxos Alternativos

### 1. Dados invÃ¡lidos

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    
    O->>S: Preenche dados com valores invÃ¡lidos
    O->>S: Clica no botÃ£o "Salvar"
    S->>S: Valida os dados informados
    S->>O: Exibe mensagens de erro nos campos invÃ¡lidos
    S->>O: MantÃ©m os dados vÃ¡lidos preenchidos
```

### 2. Membro inativo ou nÃ£o encontrado

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    participant DB as Banco de Dados
    
    O->>S: Seleciona ou informa ID de membro inexistente/inativo
    S->>DB: Busca dados do membro
    DB->>S: Retorna erro ou status inativo
    S->>O: Exibe mensagem "Membro nÃ£o encontrado ou inativo"
    S->>O: Solicita seleÃ§Ã£o de outro membro
```

### 3. Falha no upload de anexos

```mermaid
sequenceDiagram
    participant O as Operador
    participant S as Sistema
    
    O->>S: Tenta anexar arquivos muito grandes ou em formato invÃ¡lido
    S->>S: Verifica tamanho e formato
    S->>O: Exibe mensagem de erro no upload
    S->>O: MantÃ©m outros dados preenchidos
    S->>O: Permite nova tentativa de upload
```

## ğŸ“„ Exemplo de RequisiÃ§Ã£o HTTP

```http
POST /api/v1/obligations HTTP/1.1
Host: api.quilombopenabranca.org
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  "memberId": 42,
  "type": "INICIACAO",
  "date": "2023-05-15",
  "description": "IniciaÃ§Ã£o de santo no CandomblÃ© Angola",
  "observations": "CerimÃ´nia ocorreu sem intercorrÃªncias",
  "officiant": "Pai JoÃ£o de Angola",
  "location": "Terreiro Pena Branca"
}
```

## ğŸ“„ Exemplo de Resposta (Sucesso)

```json
{
  "id": 123,
  "memberId": 42,
  "memberName": "Maria da Silva",
  "type": "INICIACAO",
  "date": "2023-05-15",
  "description": "IniciaÃ§Ã£o de santo no CandomblÃ© Angola",
  "observations": "CerimÃ´nia ocorreu sem intercorrÃªncias",
  "officiant": "Pai JoÃ£o de Angola",
  "location": "Terreiro Pena Branca",
  "createdAt": "2023-05-20T14:30:45Z",
  "createdBy": "Carlos Operador",
  "attachments": []
}
```

## ğŸ–¼ï¸ Interface de ReferÃªncia

![Interface de Cadastro de ObrigaÃ§Ã£o](obligation-form.png)

## ğŸ“‹ Tipos de ObrigaÃ§Ãµes

| CÃ³digo      | DescriÃ§Ã£o                      |
|-------------|--------------------------------|
| INICIACAO   | IniciaÃ§Ã£o / Feitura de Santo   |
| OBORI       | Obori / Bori                   |
| CONFIRMACAO | ConfirmaÃ§Ã£o                    |
| DECANIA     | Decania / 7 anos               |
| QUITANDA    | Quitanda / ObrigaÃ§Ã£o de 14 anos|
| FOLHA       | Folha / ObrigaÃ§Ã£o de 21 anos   |
| CUIA        | Cuia / ObrigaÃ§Ã£o de BalÃ©       |
| SASSANHA    | Sassanha                       |
| OUTRO       | Outro tipo de obrigaÃ§Ã£o        |

---

  #### ğŸŒ™ Quilombo Pena Branca ğŸŒ™
  Honrando nossas raÃ­zes, construindo nosso futuro